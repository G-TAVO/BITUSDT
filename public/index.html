<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>BITUSDT - Simulador Financiero</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
/* ==== CSS ==== */
body{
  background:linear-gradient(120deg,#0f2027,#203a43,#2c5364);
  font-family:Arial;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.app{
  background:#111;
  padding:25px;
  width:350px;
  border-radius:15px;
  box-shadow:0 0 20px #00ffc8;
  text-align:center;
}

h1{
  color:#00ffc8;
  margin-bottom:5px;
}

.sub{
  color:#aaa;
  margin-bottom:15px;
}

.tabs button{
  background:#222;
  color:white;
  border:none;
  padding:10px;
  margin:3px;
  border-radius:5px;
  cursor:pointer;
}

section{
  display:none;
  margin-top:15px;
}

.active{
  display:block;
}

input{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:none;
  border-radius:5px;
}

button{
  width:100%;
  padding:10px;
  background:#00ffc8;
  border:none;
  border-radius:5px;
  font-weight:bold;
  cursor:pointer;
}

button:hover{
  background:#00c9a7;
}

p{
  font-size:14px;
  margin-top:5px;
}
</style>
</head>
<body>
<div class="app">
<h1>游눯 BITUSDT</h1>
<p class="sub">Simulador financiero</p>

<div class="tabs">
  <button onclick="show('login')">Login</button>
  <button onclick="show('register')">Registro</button>
  <button onclick="show('forgot')">Recuperar</button>
</div>

<!-- LOGIN -->
<section id="login" class="active">
<h2>Iniciar sesi칩n</h2>
<input id="l_email" placeholder="Correo">
<input id="l_pass" type="password" placeholder="Contrase침a">
<label><input type="checkbox" onclick="ver('l_pass')"> Ver</label>
<button onclick="login()">Entrar</button>
<p id="l_msg"></p>
</section>

<!-- REGISTRO -->
<section id="register">
<h2>Crear cuenta</h2>
<input id="r_email" placeholder="Correo">
<input id="r_pass" type="password" placeholder="Contrase침a">
<label><input type="checkbox" onclick="ver('r_pass')"> Ver</label>
<button onclick="register()">Registrarse</button>
<p id="r_msg"></p>
</section>

<!-- RECUPERAR -->
<section id="forgot">
<h2>Recuperar clave</h2>
<input id="f_email" placeholder="Correo registrado">
<button onclick="forgot()">Enviar</button>
<p id="f_msg"></p>
</section>

<!-- PANEL USUARIO SIMULADO -->
<section id="panel" style="display:none;">
<h2>Panel Cliente</h2>
<input id="amount" placeholder="Monto a invertir">
<button onclick="invertir()">Invertir</button>
<p>Saldo: <span id="saldoTxt">0</span> USDT</p>
<p>Hoy: <span id="hoyTxt">0</span> USDT</p>
<p>Total Ganancias: <span id="totalTxt">0</span> USDT</p>
<button onclick="logout()">Salir</button>
</section>

</div>

<script>
/* ==== JS ==== */
let saldo=0, total=0, hoy=0;

// Mostrar secci칩n
function show(id){
  document.querySelectorAll("section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
}

// Ver/Ocultar contrase침a
function ver(id){
  let p=document.getElementById(id);
  p.type = p.type==="password"?"text":"password";
}

// Registro (simulado)
async function register(){
  let data={
    email:r_email.value,
    password:r_pass.value
  };
  const res = await fetch("/api/register",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  });
  const json = await res.json();
  r_msg.innerText = json.msg;
}

// Login
async function login(){
  let data={
    email:l_email.value,
    password:l_pass.value
  };
  const res = await fetch("/api/login",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  });
  const json = await res.json();
  
  if(json.ok){
    localStorage.setItem("rol", json.rol);
    alert("Bienvenido "+json.rol);
    if(json.rol=="admin"){
      location="admin.html";
    }else{
      showPanel();
    }
  }else{
    l_msg.innerText = json.msg;
  }
}

// Mostrar panel usuario
function showPanel(){
  document.getElementById("login").style.display="none";
  document.getElementById("register").style.display="none";
  document.getElementById("forgot").style.display="none";
  document.getElementById("panel").style.display="block";
  update();
}

// Recuperar clave (simulado)
async function forgot(){
  const res = await fetch("/api/forgot",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({email:f_email.value})
  });
  const data = await res.json();
  f_msg.innerText = data.msg;
}

// Invertir (simulado)
function invertir(){
  let val=parseInt(amount.value);
  if(isNaN(val) || val<=0){ alert("Monto inv치lido"); return; }
  saldo+=val;
  hoy+=val*0.05;
  total+=val*0.05;
  update();
  alert("Inversi칩n enviada al admin");
  amount.value="";
}

// Actualizar panel
function update(){
  saldoTxt.innerText=saldo;
  hoyTxt.innerText=hoy.toFixed(2);
  totalTxt.innerText=total.toFixed(2);
}

// Logout
function logout(){
  localStorage.clear();
  show('login');
  saldo=0; total=0; hoy=0;
  update();
}
</script>
</body>
</html>

